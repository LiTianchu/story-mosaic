FROM node:22-bullseye

# Install nodemon globally for development
RUN npm install -g nodemon

WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm install

# Copy TypeScript config
COPY tsconfig.json ./

# Copy source code (this will be mounted as volume in development)
COPY . .

# Expose backend port
EXPOSE 5000

# Use nodemon for development with TypeScript support
CMD ["nodemon", "--watch", "src", "--ext", "ts,json", "--exec", "node --loader ts-node/esm --no-warnings", "src/index.ts"]
